# Sasso - Game Design Document

## ゲーム概要

Sassoは電卓をモチーフにした頭脳パズルゲーム。
「サッソ」と発音する。メンサ会員でないと意味を理解できない言葉。

## コンセプト

電卓の四則演算を駆使して、同じ数字を隣り合わせに作り、消していくパズルゲーム。

## 基本ルール

### 重力と詰め方向
- 重力は右端にある
- 消えた後、残った数字は右に詰められる（右に落ちていく感じ）

### 消去ルール
- 同じ数字が隣り合ったら消える
- 消えた後、残った数字が右に詰められて連鎖が発生する可能性あり

### ゲームオーバー条件
- 桁が増えて左端に到達したらゲームオーバー（桁溢れ）

### 数値ルール
- マイナス値: あり
- 小数点: 隣り合っても消去対象にならない
  - 例: 「3.3」は同じ数字が隣り合っているが消えない
  - 小数点は消去判定において「壁」のように機能する

### 初期状態
- ゲーム起動時の年月日時分秒から初期値を生成
- 例: 2025年12月25日 14:30:45 → 「20251225143045」または加工した値
- 毎回異なる初期状態でゲームが始まる

### ゲーム開始タイミング
- どちらかのプレイヤーが何かボタンを押した瞬間にゲーム開始
- 押した瞬間の時刻が初期値の生成に使われる
- ボタンを押すと同時に最初の予告が出現し、4.2秒のカウントダウン開始
- 押したボタンはそのまま最初の入力として扱われる
  - 例: 「1」を押して開始 → 「1」がすでに入力された状態でゲーム開始
  - 数字ボタンで開始すると不利（意図せず数字が入力されてしまう）
  - Cや=など、影響の少ないボタンで開始するのが賢い
  - ゆっくり初期値を眺める猶予はない

### 配牌アルゴリズム（予告で出す演算）
- 掛け算ばかりだと攻撃と区別がつかなくなるため、バランスが重要

#### 演算子の出現確率（初期値）
- 足し算: 40%
- 引き算: 30%
- 掛け算: 15%
- 割り算: 15%

#### 数字の範囲（演算子別）
- 足し算: 大きめ（桁が増えにくいため）
- 引き算: 中程度
- 掛け算: 小さめ（桁が急増するのを防ぐ）
- 割り算: 小さめ（小数点が出やすいため）

#### 難易度の進行
- 時間経過で掛け算の確率を徐々に上げる
- 数字の範囲も徐々に広げる

## ゲームモード

### 練習モード

- お題なし、時間制限なし
- 自分で自由に数字を打って消すだけ
- ルールや消去の仕組みを理解するためのモード
- スコアは記録されない（または別枠）

### 1人用エンドレスモード

落ちものパズル形式:
- 「4.2秒後に ×7 が来る」のように、演算子と数字の両方が予告される
- 予告時間: 4.2秒
- プレイヤーは予告を見て、待ち構える数字を自分で打って準備する
- 予告された演算が実行され、結果に対して消去判定が行われる
- 例: 現在「12」で「×7」が予告 → 84になる → 隣り合う8と4を作っておけば消せる

### 2人対戦モード

- 桁溢れさせたら勝ち

#### 攻撃システム
- 攻撃発動条件:
  - 3つ以上の同じ数字を同時に消す
  - 2連鎖以上を発生させる
- 攻撃効果: 相手の次の計算が「掛け算」に強制される
- 掛け算は数字が大きくなりやすいため、攻撃として効果的

#### 攻撃の激しさ
- 攻撃の強さは、連鎖が起きる前にプレイヤーが使った計算によって変化
- 例: 掛け算や割り算を駆使して準備した場合はより強力な攻撃
- 電卓の下にそのターンで使った計算式を表示（攻撃強度の可視化）

## スコアリング（案）

### 基本点
- 2つ消し: 基本点
- 3つ以上消し: ボーナス点
- 連鎖: 連鎖数に応じてボーナス

### 演算による点数調整
- 足し算・引き算: 点数低め（調整が簡単なため）
- 掛け算・割り算: 点数高め（難易度が高いため）

## 検討事項

- [x] 連鎖の詰め方向 → 右詰め（重力は右端）
- [x] ターン制か、リアルタイムか → 落ちものパズル形式（予告＋待機時間）
- [x] 予告される演算の種類 → 演算子と数字の両方（例: ×7）
- [x] 予告の表示時間 → 4.2秒
- [x] 小数点を含む数値の詳細な扱い → 「3.3」のような場合も消えない（小数点が壁）
- [x] 2人対戦時の攻撃発動条件 → 3つ以上同時消し or 2連鎖以上
- [x] 対戦時の画面構成 → 横画面で左右に電卓、大きさは対等
- [x] 初期状態 → 起動時の年月日時分秒から生成（毎回異なる）
- [x] 配牌アルゴリズム → +40%/-30%/×15%/÷15%、数字は演算子別、時間で難化

## 画面設計

### 基本レイアウト
- スマホの縦長画面を基本とする
- 電卓自体が縦長なのでちょうど良い

### メニューバー（上部・Classic MacOS風）

左側（実際のメニュー）:
- アイコン: GitHub猫のSVG
- ゲームモード選択
- リセット
- その他の設定

右側（ステータス表示）:
- 計算回数
- 点数
- その他のゲーム情報

### 予告表示エリア
- 電卓ウィンドウの少し上に配置
- 「×7」のような次に来る演算を表示
- カウントダウンはアナログ時計風（数字だとゲームの数字とややこしい）

### 計算式表示エリア
- 電卓ウィンドウの下に配置
- そのターンでプレイヤーが打った計算式を表示
- 対戦モードでは攻撃強度の可視化に使用

### 対戦モード画面（横画面）
- 左右に電卓を配置、大きさは対等
- 各電卓の上に予告表示エリア
- 各電卓の下に計算式表示エリア
- 中央または上部にゲーム情報（スコア、攻撃ゲージなど）

## 今後の開発方針

ルールは試行錯誤で決定していく。
